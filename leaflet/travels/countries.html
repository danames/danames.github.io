<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dan Ames to See the World</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-omnivore@0.3.4/leaflet-omnivore.min.js"></script> 

    <script>
        var map;
        var countryLayers = {};  // Object to store country layers

        function init() {
            // Initialize the map and set the global view
            map = L.map("map_id").setView([20, 0], 2);

            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            // Load KML files into countryLayers object
            let countries = ["australia", "bahrain", "canada", "cayman", "czechia", "england", 
                             "france", "germany", "japan", "mexico", "spain", "switzerland", 
                             "thailand", "thenetherlands", "usa", "vietnam"];
            
            countries.forEach(country => {
                countryLayers[country] = omnivore.kml(`kml/${country}.kml`).on('ready', function() {
                    this.setStyle({color: "blue"});  // Optional: Set country boundary color
                });
            });

            // Reset view to the world
            setCountry("none");
        }

        function setCountry(theCountry) {
            console.log("Selected:", theCountry);

            // Remove all layers before adding a new one
            Object.values(countryLayers).forEach(layer => map.removeLayer(layer));

            if (theCountry !== "none") {
                let selectedLayer = countryLayers[theCountry];
                if (selectedLayer) {
                    map.addLayer(selectedLayer);
                    map.fitBounds(selectedLayer.getBounds());
                    document.getElementById("viewing").innerText = fullName(theCountry);
                    document.getElementById("ifInfo").src = "https://en.wikipedia.org/wiki/" + fullName(theCountry);
                }
            } else {
                map.setView([20, 0], 2);
                document.getElementById("viewing").innerText = "Earth";
                document.getElementById("ifInfo").src = "https://en.wikipedia.org/wiki/Earth";
            }
        }

        function fullName(country) {
            const names = {
                "england": "United Kingdom",
                "usa": "United States of America",
                "thenetherlands": "The Netherlands",
                "cayman": "Cayman Islands"
            };
            return names[country] || country.charAt(0).toUpperCase() + country.slice(1);
        }
    </script>
</head>
<body onload="init()">
    <h1>Dan Ames to See the World</h1>
    <p>Interactive map of visited countries.</p>

    <div id="map_id" style="width: 600px; height: 400px;"></div>

    <h2>Select a Country</h2>
    <select onchange="setCountry(this.value)">
        <option value="none">(Choose a country)</option>
        <option value="australia">Australia</option>
        <option value="bahrain">Bahrain</option>
        <option value="canada">Canada</option>
        <option value="cayman">Cayman Islands</option>
        <option value="czechia">Czechia</option>
        <option value="england">United Kingdom</option>
        <option value="france">France</option>
        <option value="germany">Germany</option>
        <option value="japan">Japan</option>
        <option value="mexico">Mexico</option>
        <option value="spain">Spain</option>
        <option value="switzerland">Switzerland</option>
        <option value="thailand">Thailand</option>
        <option value="thenetherlands">The Netherlands</option>
        <option value="usa">USA</option>
        <option value="vietnam">Vietnam</option>
    </select>

    <h2>Selected Country</h2>
    <p id="viewing">Earth</p>
    
    <iframe id="ifInfo" src="https://en.wikipedia.org/wiki/Earth" width="600" height="400"></iframe>

</body>
</html>
